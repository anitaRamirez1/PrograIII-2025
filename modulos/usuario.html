<form id="frmAlumnos">
    <div class="card text-bg-dark" style="min-width: 700px;">
        <div class="card-header">ADMINISTRACION DE USUARIOS</div>
        <div class="card-body">
            <div class="row p-1">
                <div class="col-3 col-md-2">USUARIO</div>
                <div class="col-9 col-md-3">
                    <input required type="text" id="txtUsuario" name="txtUsuario" class="form-control form-control-sm" />
                </div>
            </div>
            <div class="row p-1">
                <div class="col-3 col-md-2">CLAVE</div>
                <div class="col-9 col-md-4">
                    <input required type="text" id="txtClave" name="txtClave" class="form-control form-control-sm" />
                </div>
            </div>
            <div class="row p-1">
                <div class="col-3 col-md-2">NOMBRE</div>
                <div class="col-9 col-md-8">
                    <input required type="text" id="txtNombre" name="txtNombre" class="form-control form-control-sm" />
                </div>
            </div>
            <div class="row p-1">
                <div class="col-3 col-md-2">DIRECCION</div>
                <div class="col-9 col-md-3">
                    <input type="text" id="txtDireccion" name="txtDireccion" class="form-control form-control-sm" />
                </div>
            </div>
            <div class="row p-1">
                <div class="col-3 col-md-2">TELEFONO</div>
                <div class="col-9 col-md-4">
                    <input type="text" id="txtTelefono" name="txtTelefono" class="form-control form-control-sm" />
                </div>
            </div>
        </div>
        <div class="card-footer text-center">
            <input type="submit" id="btnGuardarUsuario" name="btnGuardarUsuario" class="btn btn-primary" value="GUARDAR" />
            <input type="reset" id="btnNuevoUsuario" name="btnNuevoUsuario" class="btn btn-warning" value="NUEVO" />
            <input type="button" id="btnBuscarUsuario" name="btnBuscarUsuario" class="btn btn-info" value="BUSCAR" />
        </div>
    </div>
</form>
<script>
    var accion = "nuevo",
        idAlumno = 0;
    
    frmAlumnos.addEventListener("submit",e=>{
        e.preventDefault();
        guardarUsuarios();
    });
    async function guardarUsuarios(){
        let datos = {
            accion,
            idAlumno,
            usuario: txtUsuario.value,
            clave: txtClave.value,
            nombre: txtNombre.value,
            direccion: txtDireccion.value,
            telefono: txtTelefono.value
        };
        let response = await fetch("/usuarios",{
            method: "POST",
            body: JSON.stringify(datos),
        }), 
            respuesta = await response.json();
        if(respuesta.msg!="ok"){
            alertify.error(`Error al procesar usuario: ${respuesta}`);
            return;
        }
        limpiarFormulario();
        obtenerUsuarios();
    }
    function limpiarFormulario(){
        accion = "nuevo";
        idAlumno = 0;
        txtUsuario.value = "";
        txtClave.value = "";
        txtNombre.value = "";
        txtDireccion.value = "";
        txtTelefono.value = "";
    }
    function mostrarUsuario(usuario){
        accion = "modificar";
        idUsuario = usuario.idUsuario;
        txtUsuario.value = usuario.usuario;
        txtClave.value = usuario.clave;
        txtNombre.value = usuario.nombre;
        txtDireccion.value = usuario.direccion;
        txtTelefono.value = usuario.telefono;
    }
    btnBuscarUsuario.addEventListener("click", e=>{
        e.preventDefault();
        abrirVentana('busqueda_usuarios');
    });
</script>
